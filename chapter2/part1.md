# Главные конструкции C# (Часть 1)

## Метод Main()

Метод ``Main`` — это точка входа приложения C#. В программе на C# может существовать только одна точка входа. Метод ``Main`` должен быть помечен ключевым словом ``static``.

При запуске приложения, первым вызывается метод ``Main``. Если в проекте несколько классов с методом ``Main``, программу нужно компилировать с параметром компилятора StartupObject, чтобы указать, какой из методов ``Main`` будет использоваться в качестве точки входа. 

Точку входа можно создавать с любой из сигнатур
```csharp
static void Main() { }
static int Main() { }
static void Main(string[] args) { }
static int Main(string[] args) { }
```

### Асинхронный метод Main() [C# 7.1]

Метод ``Main`` также может быть асинхронным 
```csharp
static async Task Main() { }
static async Taskint Main() { }
static async Task Main(string[] args) { }
static async Taskint Main(string[] args) { }
```

### Операторы верхнего уровня [C# 9.0]

Точку входа можно задать неявно с помощью операторов верхнего уровня
```csharp
using System;
Console.WriteLine(Hello, World!);
```
Этот код аналогичен предыдущему:
```csharp
using System;
namespace Application
{
    class Program
    {
        static void Main()
        {
            Console.WriteLine(Hello World!);
        }
    }
}
```
Существует ряд правил использования операторов верхнего уровня:
* Проект может содержать только один файл с операторами верхнего уровня. В проекте с операторами верхнего уровня нельзя использовать параметр компилятора ``-main`` для выбора точки входа, в случае использования нескольких методов Main.
* Директивы ``using`` должны быть записаны до операторов верхнего уровня.
* Операторы верхнего уровня неявно находятся в глобальном пространстве имен.
* Операторы верхнего уровня должны быть записаны до объявлений пространств имен, типов, функций.
* Операторы верхнего уровня могут ссылаться на переменную ``args``

### Аргументы командной строки
Для того чтобы получить аргументы командной строки достаточно определить метод ``Main`` следующим образом:
```csharp
static void Main(string[] args)
{
    ...
}
```
Аргумент ``args`` представляет собой строковый массив.

Другим подходом к получению аргументов командной строки является метод ``GetCommandLineArgs()`` типа ``System.Environment``, который работает с любой сигнатурой метода ``Main``.

## Форматирование

### Форматирование консольного вывода

Платформа .NET представляет возможность указать заполнители консольного вывода:
```csharp
Console.WriteLine("Hello, {1}, {0}{2}{2}", "how are you", "man", "?");
```
Порядковые числа заполнителей всегда начинаются с 0. Заполнители могут располагаться в любом порядке и любое количество раз.

В случае, если уникальных заполнителей больше, чем заполняющих аргументов, то будет выдано исключение. Если меньше - заполняющие аргументы игнорируются.

### Форматирование числовых данных

Для численных данных определены различные символы форматирвания:
Символ | Пример | Описание
--- | --- | ---
"C" или "c" | 500.5 -> $500.5 | Валюта (зависит от культуры)
"D" или "d" | 499 -> 00499 | Минимальное количество разрядов для представления десятичного числа
"E" или "e" | 1052.0329112756 -> 1.052033E+003 | Экспоненциальное представление десятичного числа
"F" или "f" | 1234.567 -> 1234.57 | Представление числа с фиксированной точкой (зависит от культуры)
"G" или "g" | -1.234567890e-25 -> 1,23456789E-25 | Совмещает "E" и "F" (зависит от культуры)
"N" или "n" | 1234.567 -> 1 234 57 | Базовое числовое форматирование (зависит от культуры)
"P" или "p" | 1 -> 100 % | Число, умноженное на 100, с символом % (зависит от культуры)
"R" или "r" | 1234.1234 -> 1234.1234 | строка, дающая при обратном преобразовании идентичное число
"X" или "x" | 255 -> FF | Шестнадцатеричное число

Символы форматирования можно использовать следующим образом:
```csharp
Console.WriteLine("Сurrency {0:C}, Percentages {1:P}", cur, per);
```

### Форматирование строкового литерала

Для форматирования строки можно воспользоваться статическим методом ``string.Format()``:
```csharp
string str = string.Format("100000 in hex is {0:x}", 100000);
```
